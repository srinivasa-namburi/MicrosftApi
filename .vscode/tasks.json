{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "build",
      "type": "process",
      "command": "dotnet",
      "args": ["build", "--nologo"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "silent",
        "focus": false,
        "panel": "shared"
      },
      "problemMatcher": "$msCompile"
    },
    {
      "label": "build solution",
      "type": "process",
      "command": "dotnet",
      "args": ["build", "src/Microsoft.Greenlight.slnx", "--nologo"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "problemMatcher": "$msCompile"
    },
    {
      "label": "watch AppHost",
      "type": "process",
      "command": "dotnet",
      "args": ["watch", "--project", "src/Microsoft.Greenlight.AppHost/Microsoft.Greenlight.AppHost.csproj", "run"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "new"
      },
      "problemMatcher": {
        "base": "$msCompile",
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^dotnet watch",
          "endsPattern": "^dotnet watch ðŸš€ Started|^info: Aspire|^\\s*Now listening on"
        }
      },
      "isBackground": true
    },
    {
      "label": "test",
      "type": "process",
      "command": "dotnet",
      "args": ["test", "--nologo"],
      "group": "test",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "problemMatcher": "$msCompile"
    },
    {
      "label": "clean",
      "type": "process",
      "command": "dotnet",
      "args": ["clean", "--nologo"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "silent",
        "focus": false,
        "panel": "shared"
      },
      "problemMatcher": "$msCompile"
    },
    {
      "label": "kill-ports",
      "type": "shell",
      "command": "bash",
      "args": ["-c", "pkill -f Microsoft.Greenlight || echo 'No processes to kill'"],
      "presentation": {
        "echo": false,
        "reveal": "never",
        "focus": false,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "setup-wsl-networking",
      "type": "shell",
      "command": "bash",
      "args": ["-c", "echo 'Setting up WSL networking for Windows access...' && echo 'WSL IP:' $(hostname -I | awk '{print $1}') && echo '' && echo 'Option 1 - Direct WSL IP access (if Windows can reach WSL):' && echo 'Aspire Dashboard: https://'$(hostname -I | awk '{print $1}')':17209' && echo 'Web App: https://'$(hostname -I | awk '{print $1}')':5001' && echo '' && echo 'Option 2 - Port forwarding (recommended):' && echo 'Run these commands in Windows PowerShell as Administrator:' && echo 'netsh interface portproxy add v4tov4 listenport=17209 listenaddress=0.0.0.0 connectport=17209 connectaddress='$(hostname -I | awk '{print $1}') && echo 'netsh interface portproxy add v4tov4 listenport=5001 listenaddress=0.0.0.0 connectport=5001 connectaddress='$(hostname -I | awk '{print $1}') && echo '' && echo 'Then access:' && echo 'Aspire Dashboard: https://localhost:17209' && echo 'Web App: https://localhost:5001'"],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "new"
      },
      "problemMatcher": []
    },
    {
      "label": "test-wsl-networking",
      "type": "shell",
      "command": "${workspaceFolder}/scripts/test-wsl-networking.sh",
      "group": "test",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "new"
      },
      "problemMatcher": []
    }
  ]
}